<!doctype html><html lang=en dir=auto><head><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-0JQXY0B11G","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Tex文件版本控制 | JMx's Blog</title><meta name=keywords content="git,github,tex,论文写作"><meta name=description content="介绍如何使用git以及github desktop对tex文件进行版本控制"><meta name=author content="JMx"><link rel=canonical href=https://jiandandaoxingfu.github.io/myblog/post/git/><link rel=stylesheet href=/myblog/static/css/index.css><link crossorigin=anonymous href=/myblog/assets/css/stylesheet.min.65673a1ce570c3796eff1912e3eeb3c4cc6b95a66b91521941924906ba0afc5e.css integrity="sha256-ZWc6HOVww3lu/xkS4+6zxMxrlaZrkVIZQZJJBroK/F4=" rel="preload stylesheet" as=style><link rel=icon href=https://raw.githubusercontent.com/jiandandaoxingfu/myblog/main/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://raw.githubusercontent.com/jiandandaoxingfu/myblog/main/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://raw.githubusercontent.com/jiandandaoxingfu/myblog/main/favicon.ico><link rel=apple-touch-icon href=https://raw.githubusercontent.com/jiandandaoxingfu/myblog/main/favicon.ico><link rel=mask-icon href=https://raw.githubusercontent.com/jiandandaoxingfu/myblog/main/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.99.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-0JQXY0B11G"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0JQXY0B11G",{anonymize_ip:!1})}</script><meta property="og:title" content="Tex文件版本控制"><meta property="og:description" content="介绍如何使用git以及github desktop对tex文件进行版本控制"><meta property="og:type" content="article"><meta property="og:url" content="https://jiandandaoxingfu.github.io/myblog/post/git/"><meta property="og:image" content="https://jiandandaoxingfu.github.io/myblog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-03-27T16:09:02+08:00"><meta property="article:modified_time" content="2023-06-21T09:53:54+08:00"><meta property="og:site_name" content="JMx's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jiandandaoxingfu.github.io/myblog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Tex文件版本控制"><meta name=twitter:description content="介绍如何使用git以及github desktop对tex文件进行版本控制"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jiandandaoxingfu.github.io/myblog/post/"},{"@type":"ListItem","position":2,"name":"Tex文件版本控制","item":"https://jiandandaoxingfu.github.io/myblog/post/git/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tex文件版本控制","name":"Tex文件版本控制","description":"介绍如何使用git以及github desktop对tex文件进行版本控制","keywords":["git","github","tex","论文写作"],"articleBody":"简介 这里介绍使用git和github对tex文件做版本管理, 用来记录每次修改后文件变动的位置和内容(前提是每次修改完成后进行提交, 即 commit). git是本地的, 界面不好看, 可以使用github提供的桌面版. github支持将仓库同步到网络, 便于多人协作. 目前github归微软所有.\n一般来说, 我们可以把代码放在一个仓库(即一个文件夹)中, 每次修改后及时提交, 并加上一些注释来说明本次修改做了哪些工作. 这样做有助于回到之前的某个时刻. 更重要的是, 有助于多人协作.\n.tex 文件是文本文件, 因此可以使用git来做版本控制. 这样一方面可以记录自己的科研工作, 以及当时的想法. 另外一方面, 如果遇到投稿, 修改稿子等工作时, 不用重新建立一个文件, 同时还可以清晰的比较两个版本之间的异同, 知道哪里做了修改. 有些地方可能只是改了一个正负号, 直接从pdf文件中可能很难注意到. 另外, 不得不提一下, 很多人用日期来新建文件, 如\n paper-2022-03-01.tex paper-2022-03-03.tex paper-2022-03-27.tex, …  这种做法除了占用空间以及比较混乱, 时间久了还很难知道两个文件之间有什么区别, 改动了哪里.\n用法 首先, 我们需要下载git 和github desktop . 前者是版本控制工具, 选择合适的系统下载软件, 然后按照默认设置安装即可. 后者提供一个好看的界面, 下载安装即可使用, 后面我们主要是利用它来进行版本控制. 具体使用如下:\n创建账号 两种方式, 一种是注册一个github网络账号, 这种方式可以把仓库同步到网络. 另一种是跳过此步, 注册一个本地账号. 我们选择第二种 输入昵称和邮箱即可.\n创建仓库 创建账号以后, 就会进入创建仓库界面, 点击第二个按钮, 在本地创建新的仓库 我们创建一个名为latex的仓库, 为了方便演示, 将其放在桌面. 点击创建, 即可在桌面生成一个名为latex的文件夹 里面有一个默认的文件.gitattributes和文件夹.git. 部分电脑如果没有设置, 此文件夹会被隐藏. 它里面放的就是版本控制的信息, 因此不能删除. 这样我们的仓库就创建完成, 可以把需要做版本控制的文件或者文件夹复制进来.\n添加文件 我们创建一个关于KdV方程的论文的文件夹, 将tex文件放在里面. 然后打开github desktop软件, 可以看到 界面左侧上方显示的是发生变动的文件. 当然也有可能多个文件发生了变动, 变动的文件名前面有一个复选框. 下面示例中 有6个文件发生了变动, 右侧黄色框表示修改, 绿色框表示添加, 红色框表示删除.\n界面左侧下方显示两个文本框和一个提交按钮. 第一个文本框是必填项, 称为提交信息, 字数有限制. 添加文件默认是Create ..., 修改文件默认是Update ..., 删除文件默认是Delete .... 可以根据变动自行填写. 第二个文本框可选, 称为提交描述, 无字数限制. 可以用来说明修改了什么, 谁做了修改, 为什么做修改等等. 填完两个文本框以后, 就可以提交本次修改. 这里可以勾选某个文件不做提交. 比如修改了两个文件, 目的不同, 想要分别提交, 就可以一次选择一个文件提交. 一次提交对应于仓库的一个版本. 下图是一个比较规范的提交信息示例 界面右侧显示文件修改了哪里, 具体到哪一行. 下面示例中 可以看到修改的地方会高亮. 其中粉红色部分表示删除的(老的), 行首有一个减号. 浅蓝色部分表示添加的(新的), 行首有一个加号. 两个箭头之间(如151-171行之间)表示折叠, 这一部分没有发生变动. 注意, 因为对比时是一行一行的比较, 为了是变动看起来方便, 一定要多换行(如句号后换行), 否则, 不容易对比. 每次提交前, 填写提交信息, 然后检查修改的地方是否有问题, 没有问题就可以点击提交按钮(commit to main), 创建一个新的版本. 我们将添加的KdV.tex文件提交, 提交信息默认即可.\n历史版本 接下来, 我们修改KdV.tex并保存, 此时github desktop界面如下 可以发现我们把 v(n, t) 修改成了 h(n, t), To this end 改成了 So 并换行. 注意这里因为To this end没有另起一行, 所以对比的时候放在了一块. 然后填写提交信息, 点击提交. 在历史版本(Hirtory)中查看 可以看到这个仓库(文件夹)已经有三个版本, 第一个版本是我们创建仓库的时候软件默认提交. 第二个版本是添加KdV文件时提交, 第三个版本是更改KdV文件时提交. 点击相应的版本, 就可以看到变动的文件和它在上一个版本中的对比.\n如果我们想要回到仓库的某个版本, 可以利用分支来得到. 右键想要回到的版本, 点击create branch from commit, 可以生成一个分支(原来的称为主支, main), 该分支中的文件会回退到此版本. 而切换到主支, 仓库又会回到最新的版本. 如下所示 var url = 'images\\/branch.mp4'; var div = document.getElementById('images\\/branch.mp4'); div.innerHTML = `您的浏览器不支持 video 标签。 `;   上面的视频, 我们以Create KdV.tex版本创建分支, 填写分支名, 点击确认, 然后整个文件夹就会回到这个版本. 在这个分支中, KdV.tex文件是刚添加时的状态, 如果有其它文件, 那么也类似. 而如果又想回到修改的版本, 只需要切换到主支即可.\n完整操作视频 var url = 'images\\/github.mp4'; var div = document.getElementById('images\\/github.mp4'); div.innerHTML = `您的浏览器不支持 video 标签。 `;    可以把所有的tex文件夹都放在latex仓库中, 方便管理. 当然, 每个tex最好单独放在一个子文件夹中. 全放在一个文件夹, 运行完太乱了.\n  一定要经常对tex文件进行备份, 几年的工作, 如果因为电脑出了故障之类的问题, 把tex文件搞丢了, 不得吐血. 可以使用百度网盘之类的, 或者使用将仓库同步到github, 当然需要设置为私密. 另外, 使用Ctex等软件运行tex以后, 会生成一个临时的文件. 例如对于 KdV.tex, 对应的临时文件为KdV.tex.bak文件. 在Ctex偶尔抽风导致KdV.tex变成空白的时候, 临时文件就救了大命. 这时只需要删除KdV.tex文件, 然后把临时文件的后缀.bak删除就可以了. 当然, 经常备份就不怕这种问题了.\n  git 可以通过添加.gitignore文件来忽略对特定类型的文件或者文件夹不做版本控制. 由于tex文件编译后, 会生成很多临时文件和pdf文件, 这些文件是没有必要做版本控制的, 特别是pdf文件等非文本文件, git不支持对他们做对比, 只会增加仓库的大小. 提交的时候可以只勾选.tex文件, 但是这样比较麻烦. 一劳永逸的办法是添加.gitignore文件. 针对tex类型仓库的gitignore文件内容为\n # latex *.pdf *.fls *.gz *.log *.aux *.out *.dvi *.bbl *.blg *.glo *.gls *.ind *.inx *.toc *.sav *.lof *.tmp *.out.bak *.nav *.snm *.synctex.gz(busy) *.synctex(busy) *.gz(busy) *.fdb_latexmk *.xdv \r#download a::hover {\rtransform: scale(0.8);\r}\r\rvar url = 'files\\/gitignore.zip'\rif (url.startsWith('file')) {\rurl = window.location.href.replace(/#.*/, '') + url;\r}\rvar text = '下载gitignore文件';\rvar type = url.slice(url.lastIndexOf('.') + 1);\rvar span = document.getElementById('files\\/gitignore.zip');\rspan.innerHTML = `\r\r${text}\r`\r\r 下载以后, 把它复制到latex文件夹中, 然后提交即可.\n示例 1 情景如下: 我把论文发给了导师, 导师修改后发给了师兄, 让师兄再帮忙改改. 师兄又转发给了我, 他改的同时让我也再改改. 最后就会产生四个版本: 我发给老师的版本1, 老师发给师兄的版本2, 师兄在版本2上修改的版本3, 我在版本2上修改的版本4.\n使用github版本控制, 首先把版本1提交(即commit), 然后复制版本2的内容到版本1中, 再次提交, 可以对比出老师修改的地方. 首先逐一检查老师修改的地方是否有问题, 并且在此基础上修改, 即版本4. 收到师兄修改的版本3时, 首先将版本4提交. 然后从版本2创建分支, 切换到分支, 将版本3的内容复制到分支中的版本2, 提交, 生成版本3. 可以对比出师兄修改的地方. 下面需要将师兄的版本3与我的版本4对比然后合并, 得到最终版本. 如果使用git的合并功能, 需要解决冲突问题, 保险起见, 可以按照以下步骤. 首先把版本4文件复制到仓库以外的文件夹, 打开, 然后切换到分支, 打开版本3, 根据师兄修改的地方, 对仓库外的版本4上进行修改. 修改完成以后, 切换到主支, 把版本4的文件用仓库外的版本4替换掉即可. 具体如下图所示 其它命令 追加 如果对仓库某个文件做了很小的修改, 觉得没有必要单独创建一个新的版本, 可以将改动追加到上一个版本. 只需要右键最新的版本, 点击Amend commit就可以重新提交, 可以修改提交信息和提交描述. 合并 git还支持把多个版本合并成一个版本, 不过此方法可能会出现冲突情况, 因此不熟练的话不要合并. 合并步骤如下: 在git 命令行中输入(以最近的4次提交合并成一个为例)\ngit rebase -i HEAD~4 此时会打开一个窗口, 用来完成此次合并, 其内容为\npick 70d651c update: maple-latex # 倒数第四个 pick 8ef0aa9 update: maple-latex pick a96ed9e update: maple-latex pick 2cfc89e update: maple-latex # 最新的  # Rebase a7d2d47..2cfc89e onto a7d2d47 (4 commands) # ... 里面会显示最近四次提交的 summary. 因为四次提交做的是同一件事(当然, 每次提交都是在前一版本上做修改, 而且可能有不同的 description ), 所以我们可以把 最新的三次提交合并到倒数第四次, 将四次提交变成一次. 我们需要修改上述文件为\npick 70d651c update: maple-latex # 倒数第四个 s 8ef0aa9 update: maple-latex s a96ed9e update: maple-latex s 2cfc89e update: maple-latex # 最新的  # Rebase a7d2d47..2cfc89e onto a7d2d47 (4 commands) # ... 这里的 pick 表示保留该 commit, 而 s(squash) 则表示将此次 commit 合并到前一个 commit. 需要注意的是, 这四次提交合并的时候可能会出现冲突, 此时回到 github, 它会有一个弹窗, 告诉你哪些文件在合并的时候出现了冲突. 我们需要手动解决冲突, 一般来说选择最新的文件即可 (commit … in …).\npull request \u0026\u0026 fetch upstream 这两个功能出现在多人协作中. 当我们Fork别人的代码进行修改, 提交到自己的仓库. 然后可以提Pull Request (PR), 等待原仓库作者审阅, 合并. 如果在修改过程中, 原仓库有了新的提交, 如果需要更新Fork过来的仓库, 可以使用fetch upstream功能.\n正常情况下, Github会给Fork的仓库上面提示和原仓库多了几次提交, 少了几次提交 对于多的, 我们可以Pull Request. 如果少了, 可以fetch upstream. 后者对于某些文件可能会出现冲突, 时我们可以根据github提示, 使用命令行工具进行修改. 在解决冲突文件时, 文件中会有如下的符号 «« b… 对这一部分内容保留想要的即可解决冲突.\n","wordCount":"539","inLanguage":"en","datePublished":"2022-03-27T16:09:02+08:00","dateModified":"2023-06-21T09:53:54+08:00","author":{"@type":"Person","name":"JMx"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jiandandaoxingfu.github.io/myblog/post/git/"},"publisher":{"@type":"Organization","name":"JMx's Blog","logo":{"@type":"ImageObject","url":"https://raw.githubusercontent.com/jiandandaoxingfu/myblog/main/favicon.ico"}}}</script><script>document.addEventListener("click",t=>{if(t.target.className==="overlay"||t.target.parentElement.className==="overlay"){document.body.removeChild(document.querySelector(".overlay"));return}if(t.target.tagName.toUpperCase()==="IMG"){var e,o,s=t.target,n=document.createElement("div");n.classList.add("overlay"),e=document.createElement("img"),e.src=s.src,e.alt=s.alt,n.appendChild(e),document.body.appendChild(n),o=.9*Math.min(window.innerWidth/e.clientWidth,window.innerHeight/e.clientHeight),e.style.transform=`scale(${o})`}}),window.onload=()=>{if(window.location.href.endsWith("myblog/")){let e=document.createElement("script");e.src="/myblog/static/js/three.min.js",document.head.appendChild(e),setTimeout(()=>{let e=document.createElement("script");e.src="/myblog/static/js/icon3d.js",document.head.appendChild(e)},250)}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jiandandaoxingfu.github.io/myblog/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jiandandaoxingfu.github.io/myblog/post/ title=Blog><span>Blog</span></a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Tex文件版本控制</h1><div class=post-meta><span title="2022-03-27 16:09:02 +0800 +0800">发布: March 27, 2022</span>&nbsp;·&nbsp;<span title="2023-06-21 09:53:54 +0800 +0800">更新: June 21, 2023</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;JMx</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%ae%80%e4%bb%8b aria-label=简介>简介</a></li><li><a href=#%e7%94%a8%e6%b3%95 aria-label=用法>用法</a><ul><li><a href=#%e5%88%9b%e5%bb%ba%e8%b4%a6%e5%8f%b7 aria-label=创建账号>创建账号</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e4%bb%93%e5%ba%93 aria-label=创建仓库>创建仓库</a></li><li><a href=#%e6%b7%bb%e5%8a%a0%e6%96%87%e4%bb%b6 aria-label=添加文件>添加文件</a></li><li><a href=#%e5%8e%86%e5%8f%b2%e7%89%88%e6%9c%ac aria-label=历史版本>历史版本</a></li><li><a href=#%e5%ae%8c%e6%95%b4%e6%93%8d%e4%bd%9c%e8%a7%86%e9%a2%91 aria-label=完整操作视频>完整操作视频</a></li><li><a href=#%e7%a4%ba%e4%be%8b-1 aria-label="示例 1">示例 1</a></li></ul></li><li><a href=#%e5%85%b6%e5%ae%83%e5%91%bd%e4%bb%a4 aria-label=其它命令>其它命令</a><ul><li><a href=#%e8%bf%bd%e5%8a%a0 aria-label=追加>追加</a></li><li><a href=#%e5%90%88%e5%b9%b6 aria-label=合并>合并</a></li><li><a href=#pull-request--fetch-upstream aria-label="pull request &amp;amp;&amp;amp; fetch upstream">pull request && fetch upstream</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=简介>简介<a hidden class=anchor aria-hidden=true href=#简介>#</a></h2><p>这里介绍使用git和github对tex文件做版本管理, 用来记录每次修改后文件变动的位置和内容(前提是每次修改完成后进行提交, 即 commit).
git是本地的, 界面不好看, 可以使用github提供的桌面版.
github支持将仓库同步到网络, 便于多人协作.
目前github归微软所有.</p><p>一般来说, 我们可以把代码放在一个仓库(即一个文件夹)中, 每次修改后及时提交, 并加上一些注释来说明本次修改做了哪些工作.
这样做有助于回到之前的某个时刻. 更重要的是, 有助于多人协作.</p><p><strong>.tex</strong> 文件是文本文件, 因此可以使用git来做版本控制.
这样一方面可以记录自己的科研工作, 以及当时的想法.
另外一方面, 如果遇到投稿, 修改稿子等工作时, 不用重新建立一个文件, 同时还可以清晰的比较两个版本之间的异同, 知道哪里做了修改.
有些地方可能只是改了一个正负号, 直接从pdf文件中可能很难注意到.
另外, 不得不提一下, 很多人用日期来新建文件, 如</p><ul><li>paper-2022-03-01.tex</li><li>paper-2022-03-03.tex</li><li>paper-2022-03-27.tex,</li><li>&mldr;</li></ul><p>这种做法除了占用空间以及比较混乱, 时间久了还很难知道两个文件之间有什么区别, 改动了哪里.</p><h2 id=用法>用法<a hidden class=anchor aria-hidden=true href=#用法>#</a></h2><p>首先, 我们需要下载<a href=https://git-scm.com/download/> git </a>和<a href=https://desktop.github.com/> github desktop </a>.
前者是版本控制工具, 选择合适的系统下载软件, 然后按照默认设置安装即可.
<img loading=lazy src=images/git.png alt=git>
后者提供一个好看的界面, 下载安装即可使用, 后面我们主要是利用它来进行版本控制.
具体使用如下:</p><h3 id=创建账号>创建账号<a hidden class=anchor aria-hidden=true href=#创建账号>#</a></h3><p><img loading=lazy src=images/account.png alt=git>
两种方式, 一种是注册一个github网络账号, 这种方式可以把仓库同步到网络.
另一种是跳过此步, 注册一个本地账号.
我们选择第二种
<img loading=lazy src=images/user.png alt=git>
输入昵称和邮箱即可.</p><h3 id=创建仓库>创建仓库<a hidden class=anchor aria-hidden=true href=#创建仓库>#</a></h3><p><img loading=lazy src=images/%e5%88%9b%e5%bb%ba%e4%bb%93%e5%ba%93.png alt=git>
创建账号以后, 就会进入创建仓库界面, 点击第二个按钮, 在本地创建新的仓库
<img loading=lazy src=images/%e4%bb%93%e5%ba%93%e5%90%8d.png alt=git>
我们创建一个名为<code>latex</code>的仓库, 为了方便演示, 将其放在桌面. 点击创建, 即可在桌面生成一个名为<code>latex</code>的文件夹
<img loading=lazy src=images/%e5%88%9b%e5%bb%ba%e5%ae%8c%e6%88%90.png alt=git>
里面有一个默认的文件<code>.gitattributes</code>和文件夹<code>.git</code>.
部分电脑如果没有设置, 此文件夹会被隐藏. 它里面放的就是版本控制的信息, 因此不能删除.
这样我们的仓库就创建完成, 可以把需要做版本控制的文件或者文件夹复制进来.</p><h3 id=添加文件>添加文件<a hidden class=anchor aria-hidden=true href=#添加文件>#</a></h3><p><img loading=lazy src=images/%e6%b7%bb%e5%8a%a0%e6%96%87%e4%bb%b6.png alt=git>
我们创建一个关于KdV方程的论文的文件夹, 将tex文件放在里面.
然后打开github desktop软件, 可以看到
<img loading=lazy src=images/%e6%b7%bb%e5%8a%a0%e6%96%87%e4%bb%b6-github.png alt=git>
界面左侧上方显示的是发生变动的文件. 当然也有可能多个文件发生了变动, 变动的文件名前面有一个复选框.
下面示例中
<img loading=lazy src=images/checkbox.png alt=git>
有6个文件发生了变动, 右侧黄色框表示修改, 绿色框表示添加, 红色框表示删除.</p><p>界面左侧下方显示两个文本框和一个提交按钮.
第一个文本框是必填项, 称为提交信息, 字数有限制.
添加文件默认是<code>Create ...</code>, 修改文件默认是<code>Update ...</code>, 删除文件默认是<code>Delete ...</code>.
可以根据变动自行填写.
第二个文本框可选, 称为提交描述, 无字数限制.
可以用来说明修改了什么, 谁做了修改, 为什么做修改等等.
填完两个文本框以后, 就可以提交本次修改. 这里可以勾选某个文件不做提交.
比如修改了两个文件, 目的不同, 想要分别提交, 就可以一次选择一个文件提交.
一次提交对应于仓库的一个版本.
下图是一个比较规范的提交信息示例
<img loading=lazy src=images/good-commit-msg.png alt></p><p>界面右侧显示文件修改了哪里, 具体到哪一行. 下面示例中
<img loading=lazy src=images/history-update.png alt=git>
可以看到修改的地方会高亮. 其中粉红色部分表示删除的(老的), 行首有一个减号. 浅蓝色部分表示添加的(新的), 行首有一个加号. 两个箭头之间(如151-171行之间)表示折叠, 这一部分没有发生变动.
注意, 因为对比时是一行一行的比较, 为了是变动看起来方便, 一定要多换行(如句号后换行), 否则, 不容易对比.
每次提交前, 填写提交信息, 然后检查修改的地方是否有问题, 没有问题就可以点击提交按钮(<code>commit to main</code>), 创建一个新的版本.
我们将添加的<code>KdV.tex</code>文件提交, 提交信息默认即可.</p><h3 id=历史版本>历史版本<a hidden class=anchor aria-hidden=true href=#历史版本>#</a></h3><p>接下来, 我们修改<code>KdV.tex</code>并保存, 此时github desktop界面如下
<img loading=lazy src=images/update.png alt=git>
可以发现我们把 <code>v(n, t)</code> 修改成了 <code>h(n, t)</code>, <code>To this end</code> 改成了 <code>So</code> 并换行.
注意这里因为<code>To this end</code>没有另起一行, 所以对比的时候放在了一块.
然后填写提交信息, 点击提交. 在历史版本(Hirtory)中查看
<img loading=lazy src=images/history.png alt=git>
可以看到这个仓库(文件夹)已经有三个版本, 第一个版本是我们创建仓库的时候软件默认提交.
第二个版本是添加KdV文件时提交, 第三个版本是更改KdV文件时提交.
点击相应的版本, 就可以看到变动的文件和它在上一个版本中的对比.</p><p>如果我们想要回到仓库的某个版本, 可以利用分支来得到.
右键想要回到的版本, 点击<code>create branch from commit</code>, 可以生成一个分支(原来的称为主支, main), 该分支中的文件会回退到此版本.
而切换到主支, 仓库又会回到最新的版本.
如下所示<div id=images/branch.mp4 class=post-content><script type=text/javascript>var url="images/branch.mp4",div=document.getElementById("images/branch.mp4");div.innerHTML=`<video height="100%" width="100%" controls>
            <source src=${url} type="video/mp4">
            您的浏览器不支持 video 标签。
        </video>`</script></div>上面的视频, 我们以<code>Create KdV.tex</code>版本创建分支, 填写分支名, 点击确认, 然后整个文件夹就会回到这个版本. 在这个分支中, <code>KdV.tex</code>文件是刚添加时的状态, 如果有其它文件, 那么也类似.
而如果又想回到修改的版本, 只需要切换到主支即可.</p><h3 id=完整操作视频>完整操作视频<a hidden class=anchor aria-hidden=true href=#完整操作视频>#</a></h3><div id=images/github.mp4 class=post-content><script type=text/javascript>var url="images/github.mp4",div=document.getElementById("images/github.mp4");div.innerHTML=`<video height="100%" width="100%" controls>
            <source src=${url} type="video/mp4">
            您的浏览器不支持 video 标签。
        </video>`</script></div><blockquote><p>可以把所有的tex文件夹都放在latex仓库中, 方便管理. 当然, 每个tex最好单独放在一个子文件夹中. 全放在一个文件夹, 运行完太乱了.</p></blockquote><blockquote><p>一定要经常对tex文件进行备份, 几年的工作, 如果因为电脑出了故障之类的问题, 把tex文件搞丢了, 不得吐血.
可以使用百度网盘之类的, 或者使用将仓库同步到github, 当然需要设置为私密.
另外, 使用Ctex等软件运行tex以后, 会生成一个临时的文件. 例如对于 <code>KdV.tex</code>, 对应的临时文件为<code>KdV.tex.bak</code>文件.
在Ctex偶尔抽风导致<code>KdV.tex</code>变成空白的时候, 临时文件就救了大命.
这时只需要删除<code>KdV.tex</code>文件, 然后把临时文件的后缀<code>.bak</code>删除就可以了.
当然, 经常备份就不怕这种问题了.</p></blockquote><blockquote><p>git 可以通过添加<code>.gitignore</code>文件来忽略对特定类型的文件或者文件夹不做版本控制. 由于tex文件编译后, 会生成很多临时文件和pdf文件, 这些文件是没有必要做版本控制的, 特别是pdf文件等非文本文件, git不支持对他们做对比, 只会增加仓库的大小.
提交的时候可以只勾选<code>.tex</code>文件, 但是这样比较麻烦. 一劳永逸的办法是添加<code>.gitignore</code>文件.
针对tex类型仓库的gitignore文件内容为</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># latex
</span></span><span style=display:flex><span>*.pdf
</span></span><span style=display:flex><span>*.fls
</span></span><span style=display:flex><span>*.gz
</span></span><span style=display:flex><span>*.log
</span></span><span style=display:flex><span>*.aux
</span></span><span style=display:flex><span>*.out
</span></span><span style=display:flex><span>*.dvi
</span></span><span style=display:flex><span>*.bbl
</span></span><span style=display:flex><span>*.blg
</span></span><span style=display:flex><span>*.glo
</span></span><span style=display:flex><span>*.gls
</span></span><span style=display:flex><span>*.ind
</span></span><span style=display:flex><span>*.inx
</span></span><span style=display:flex><span>*.toc
</span></span><span style=display:flex><span>*.sav
</span></span><span style=display:flex><span>*.lof
</span></span><span style=display:flex><span>*.tmp
</span></span><span style=display:flex><span>*.out.bak
</span></span><span style=display:flex><span>*.nav
</span></span><span style=display:flex><span>*.snm
</span></span><span style=display:flex><span>*.synctex.gz(busy)
</span></span><span style=display:flex><span>*.synctex(busy)
</span></span><span style=display:flex><span>*.gz(busy)
</span></span><span style=display:flex><span>*.fdb_latexmk
</span></span><span style=display:flex><span>*.xdv
</span></span></code></pre></div><p><span id=files/gitignore.zip class=post-tags><style>#download a::hover{transform:scale(.8)}</style><script type=text/javascript>var url="files/gitignore.zip",text,type,span;url.startsWith("file")&&(url=window.location.href.replace(/#.*/,'')+url),text="下载gitignore文件",type=url.slice(url.lastIndexOf(".")+1),span=document.getElementById("files/gitignore.zip"),span.innerHTML=`
        <a href='${url}' target="_blank" style="margin: 5px; display: inline-block; box-shadow: none;" download>
            <span class="file-type-icon ${type}-icon"></span>
        	${text}
        </a>`</script></span>下载以后, 把它复制到latex文件夹中, 然后提交即可.</p><h3 id=示例-1>示例 1<a hidden class=anchor aria-hidden=true href=#示例-1>#</a></h3><p><strong>情景如下</strong>: 我把论文发给了导师, 导师修改后发给了师兄, 让师兄再帮忙改改.
师兄又转发给了我, 他改的同时让我也再改改.
最后就会产生四个版本: 我发给老师的版本1, 老师发给师兄的版本2, 师兄在版本2上修改的版本3, 我在版本2上修改的版本4.</p><p>使用github版本控制, 首先把版本1提交(即commit), 然后复制版本2的内容到版本1中, 再次提交, 可以对比出老师修改的地方.
首先逐一检查老师修改的地方是否有问题, 并且在此基础上修改, 即版本4.
收到师兄修改的版本3时, 首先将版本4提交.
然后从版本2创建分支, 切换到分支, 将版本3的内容复制到分支中的版本2, 提交, 生成版本3.
可以对比出师兄修改的地方.
下面需要将师兄的版本3与我的版本4对比然后合并, 得到最终版本.
如果使用git的合并功能, 需要解决冲突问题, 保险起见, 可以按照以下步骤.
首先把版本4文件复制到仓库以外的文件夹, 打开, 然后切换到分支, 打开版本3, 根据师兄修改的地方, 对仓库外的版本4上进行修改.
修改完成以后, 切换到主支, 把版本4的文件用仓库外的版本4替换掉即可.
具体如下图所示
<img loading=lazy src=images/branch-version.jpg alt=示例图></p><h2 id=其它命令>其它命令<a hidden class=anchor aria-hidden=true href=#其它命令>#</a></h2><h3 id=追加>追加<a hidden class=anchor aria-hidden=true href=#追加>#</a></h3><p>如果对仓库某个文件做了很小的修改, 觉得没有必要单独创建一个新的版本, 可以将改动追加到上一个版本. 只需要右键最新的版本, 点击<code>Amend commit</code>就可以重新提交, 可以修改提交信息和提交描述.
<img loading=lazy src=images/amend.gif alt=amend></p><h3 id=合并>合并<a hidden class=anchor aria-hidden=true href=#合并>#</a></h3><p>git还支持把多个版本合并成一个版本, 不过此方法可能会出现冲突情况, 因此不熟练的话不要合并.
合并步骤如下: 在git 命令行中输入(以最近的4次提交合并成一个为例)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat><span style=display:flex><span>git rebase -i HEAD~4 
</span></span></code></pre></div><p>此时会打开一个窗口, 用来完成此次合并, 其内容为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat><span style=display:flex><span>pick 70d651c update: maple-latex # 倒数第四个
</span></span><span style=display:flex><span>pick 8ef0aa9 update: maple-latex
</span></span><span style=display:flex><span>pick a96ed9e update: maple-latex
</span></span><span style=display:flex><span>pick 2cfc89e update: maple-latex # 最新的
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Rebase a7d2d47..2cfc89e onto a7d2d47 (4 commands)
</span></span><span style=display:flex><span># ...
</span></span></code></pre></div><p>里面会显示最近四次提交的 summary.
因为四次提交做的是同一件事(当然, 每次提交都是在前一版本上做修改, 而且可能有不同的 description ), 所以我们可以把
最新的三次提交合并到倒数第四次, 将四次提交变成一次.
我们需要修改上述文件为</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat><span style=display:flex><span>pick 70d651c update: maple-latex # 倒数第四个
</span></span><span style=display:flex><span>s 8ef0aa9 update: maple-latex
</span></span><span style=display:flex><span>s a96ed9e update: maple-latex
</span></span><span style=display:flex><span>s 2cfc89e update: maple-latex # 最新的
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Rebase a7d2d47..2cfc89e onto a7d2d47 (4 commands)
</span></span><span style=display:flex><span># ...
</span></span></code></pre></div><p>这里的 pick 表示保留该 commit, 而 s(squash) 则表示将此次 commit 合并到前一个 commit.
需要注意的是, 这四次提交合并的时候可能会出现冲突, 此时回到 github, 它会有一个弹窗, 告诉你哪些文件在合并的时候出现了冲突.
我们需要手动解决冲突, 一般来说选择最新的文件即可 (commit &mldr; in &mldr;).</p><h3 id=pull-request--fetch-upstream>pull request && fetch upstream<a hidden class=anchor aria-hidden=true href=#pull-request--fetch-upstream>#</a></h3><p>这两个功能出现在多人协作中.
当我们Fork别人的代码进行修改, 提交到自己的仓库. 然后可以提Pull Request (PR), 等待原仓库作者审阅, 合并. 如果在修改过程中, 原仓库有了新的提交, 如果需要更新Fork过来的仓库, 可以使用fetch upstream功能.</p><p>正常情况下, Github会给Fork的仓库上面提示和原仓库多了几次提交, 少了几次提交
<img loading=lazy src=images/pull-fetch.png alt>
对于多的, 我们可以Pull Request. 如果少了, 可以fetch upstream. 后者对于某些文件可能会出现冲突, 时我们可以根据github提示, 使用命令行工具进行修改.
<img loading=lazy src=images/fetch-conflict.png alt>
在解决冲突文件时, 文件中会有如下的符号
&#171;&#171;&lt; HEAD
这一部分是我们自己的修改
== = = =
这一部分是原作者的修改
> > b&mldr;
对这一部分内容保留想要的即可解决冲突.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jiandandaoxingfu.github.io/myblog/tags/git/>git</a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/tags/github/>github</a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/tags/tex/>tex</a></li><li><a href=https://jiandandaoxingfu.github.io/myblog/tags/%E8%AE%BA%E6%96%87%E5%86%99%E4%BD%9C/>论文写作</a></li></ul><nav class=paginav><a class=prev href=https://jiandandaoxingfu.github.io/myblog/post/tikz/><span class=title>« Prev Page</span><br><span>Tikz绘图示例</span></a>
<a class=next href=https://jiandandaoxingfu.github.io/myblog/post/maple-latex/><span class=title>Next Page »</span><br><span>Maple-Latex</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://jiandandaoxingfu.github.io/myblog/>JMx's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>